<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Exam Practice</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap');
        
        body {
            font-family: 'Comic Neue', cursive;
            background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);
            min-height: 100vh;
        }

        .option-btn {
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .option-btn:active {
            transform: scale(0.95);
        }

        .progress-bar {
            transition: width 0.5s ease-in-out;
        }

        .shake {
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .bounce {
            animation: bounce 0.5s;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
    </style>
</head>
<body class="flex items-center justify-center p-4">

    <!-- Mode Selection Screen -->
    <div id="mode-screen" class="bg-white w-full max-w-lg rounded-3xl shadow-2xl overflow-hidden p-10 text-center">
        <h2 class="text-4xl font-bold text-blue-800 mb-4">ğŸ® Elige el modo</h2>
        <p class="text-gray-600 mb-8">Â¿CÃ³mo quieres practicar hoy?</p>
        
        <div class="space-y-4">
            <button onclick="startGame(false)" class="w-full bg-blue-500 text-white p-6 rounded-2xl font-bold text-xl hover:bg-blue-600 shadow-lg transform hover:scale-105 transition">
                ğŸ“– Modo Normal
                <p class="text-sm font-normal mt-1">Primero possessives, luego prepositions</p>
            </button>
            
            <button onclick="startGame(true)" class="w-full bg-purple-500 text-white p-6 rounded-2xl font-bold text-xl hover:bg-purple-600 shadow-lg transform hover:scale-105 transition">
                ğŸ² Modo Mezclado
                <p class="text-sm font-normal mt-1">Â¡Preguntas en orden aleatorio!</p>
            </button>
        </div>
    </div>

    <div id="game-container" class="hidden bg-white w-full max-w-lg rounded-3xl shadow-2xl overflow-hidden">
        <!-- Header -->
        <div class="bg-yellow-400 p-6 text-center border-b-4 border-yellow-500">
            <h1 class="text-3xl font-bold text-blue-800">ğŸ‡¬ğŸ‡§ English Adventure ğŸŒŸ</h1>
            <div class="mt-4 bg-yellow-200 rounded-full h-4 overflow-hidden border-2 border-yellow-600">
                <div id="progress" class="progress-bar bg-green-500 h-full w-0"></div>
            </div>
            <p id="stats" class="text-blue-700 font-bold mt-2 text-lg">Pregunta 1 de 40</p>
        </div>

        <!-- Question Area -->
        <div class="p-8">
            <div id="question-box" class="text-center">
                <div id="image-placeholder" class="text-6xl mb-4">ğŸ“š</div>
                <h2 id="question-text" class="text-2xl font-bold text-gray-800 mb-6 italic">
                    Cargando pregunta...
                </h2>
                
                <div id="options-grid" class="grid grid-cols-2 gap-4">
                </div>
            </div>

            <!-- Feedback Area -->
            <div id="feedback" class="hidden mt-6 p-4 rounded-2xl text-center border-2">
                <p id="feedback-msg" class="text-lg font-bold mb-2"></p>
                <p id="feedback-explanation" class="text-gray-700 italic"></p>
                <button id="next-btn" onclick="nextQuestion()" class="mt-4 bg-blue-600 text-white px-8 py-2 rounded-full font-bold hover:bg-blue-700">Siguiente â†’</button>
            </div>
        </div>
    </div>

    <!-- Final Result Screen -->
    <div id="result-screen" class="hidden bg-white w-full max-w-lg rounded-3xl shadow-2xl overflow-hidden p-10 text-center">
        <h2 class="text-4xl font-bold text-blue-800 mb-4">Â¡Juego Terminado! ğŸ‰</h2>
        <div id="final-emoji" class="text-6xl mb-6">ğŸ†</div>
        <p class="text-2xl mb-6">Has acertado <span id="final-score" class="font-bold text-green-600">0</span> de <span id="total-questions">0</span></p>
        <p id="final-message" class="mb-6 text-gray-600 font-bold px-4"></p>
        
        <div id="review-section" class="hidden mb-6 text-left bg-red-50 p-4 rounded-xl border-2 border-red-300 max-h-60 overflow-y-auto">
            <h3 class="font-bold text-red-700 mb-2 text-center">ğŸ“ Revisa tus errores:</h3>
            <div id="wrong-list"></div>
        </div>
        
        <div class="flex gap-4 justify-center flex-wrap">
            <button onclick="location.reload()" class="bg-blue-600 text-white px-8 py-3 rounded-full font-bold text-lg hover:bg-blue-700">ğŸ”„ Intentar de nuevo</button>
            <button id="review-btn" class="hidden bg-orange-600 text-white px-8 py-3 rounded-full font-bold text-lg hover:bg-orange-700">ğŸ“š Repasar errores</button>
        </div>
    </div>

    <script>
        let quizData = [
            { q: "I have a new book. ___ book is interesting.", img: "ğŸ“–", options: ["My", "His"], correct: "My", explanation: "Usamos 'My' porque el sujeto es 'I' (Yo)." },
            { q: "She has a sister. ___ sister is 8 years old.", img: "ğŸ‘§", options: ["Her", "His"], correct: "Her", explanation: "Usamos 'Her' porque hablamos de una niÃ±a (She)." },
            { q: "He has a big dog. ___ dog is brown.", img: "ğŸ•", options: ["Your", "His"], correct: "His", explanation: "Usamos 'His' porque el dueÃ±o es un niÃ±o (He)." },
            { q: "The bird is in ___ nest.", img: "ğŸ¦œ", options: ["Its", "Their"], correct: "Its", explanation: "Usamos 'Its' para animales o cosas en singular." },
            { q: "We have a house. ___ house is small.", img: "ğŸ ", options: ["Our", "Your"], correct: "Our", explanation: "Usamos 'Our' (nuestro) para nosotros (We)." },
            { q: "They play football. ___ team is the best.", img: "âš½", options: ["Their", "Our"], correct: "Their", explanation: "Usamos 'Their' para ellos (They)." },
            { q: "You have an umbrella. ___ umbrella is yellow.", img: "â˜‚ï¸", options: ["My", "Your"], correct: "Your", explanation: "Si tÃº tienes algo (You), es 'Your' (tu) paraguas." },
            { q: "Mary and Paul have a baby. ___ baby is cute.", img: "ğŸ‘¶", options: ["His", "Their"], correct: "Their", explanation: "Ellos son dos personas (They), usamos 'Their'." },
            { q: "The car has 4 doors. ___ doors are white.", img: "ğŸš—", options: ["Its", "Our"], correct: "Its", explanation: "Hablamos de las puertas del coche (objeto singular)." },
            { q: "I have a brother. ___ name is Tom.", img: "ğŸ‘¦", options: ["My", "His"], correct: "His", explanation: "Ojo: hablamos del nombre de Ã©l (He), por eso es 'His name'." },
            { q: "She loves ___ cat very much.", img: "ğŸ±", options: ["Her", "Its"], correct: "Her", explanation: "Ella ama a SU gato (de ella)." },
            { q: "He lost ___ keys yesterday.", img: "ğŸ”‘", options: ["His", "Her"], correct: "His", explanation: "Ã‰l perdiÃ³ SUS llaves (de Ã©l)." },
            { q: "We like ___ English teacher.", img: "ğŸ‘©â€ğŸ«", options: ["Our", "Their"], correct: "Our", explanation: "Nos gusta NUESTRA profesora." },
            { q: "You need to wash ___ hands.", img: "ğŸ§¼", options: ["Your", "My"], correct: "Your", explanation: "TÃº debes lavar TUS manos." },
            { q: "The tree lost ___ leaves in autumn.", img: "ğŸŒ³", options: ["Its", "Their"], correct: "Its", explanation: "El Ã¡rbol (cosa singular) perdiÃ³ SUS hojas." },
            { q: "They forgot ___ homework at home.", img: "ğŸ“š", options: ["Your", "Their"], correct: "Their", explanation: "Ellos olvidaron SU tarea." },
            { q: "I am wearing ___ favorite shoes.", img: "ğŸ‘Ÿ", options: ["My", "His"], correct: "My", explanation: "Yo llevo puestos MIS zapatos." },
            { q: "The girl is with ___ grandmother.", img: "ğŸ‘µ", options: ["Her", "His"], correct: "Her", explanation: "La niÃ±a estÃ¡ con SU abuela." },
            { q: "The phone is ringing. ___ screen is broken.", img: "ğŸ“±", options: ["Its", "My"], correct: "Its", explanation: "La pantalla DEL telÃ©fono (objeto)." },
            { q: "We are painting ___ bedroom blue.", img: "ğŸ›ï¸", options: ["Our", "Their"], correct: "Our", explanation: "Estamos pintando NUESTRO cuarto." },
            { q: "The keys are ___ the table.", img: "ğŸ”‘", options: ["On", "In"], correct: "On", explanation: "'On' es sobre la superficie." },
            { q: "My dad is ___ work right now.", img: "ğŸ’¼", options: ["At", "On"], correct: "At", explanation: "Usamos 'At' para lugares especÃ­ficos (at work, at school)." },
            { q: "I am playing ___ my best friend.", img: "ğŸ‘«", options: ["With", "At"], correct: "With", explanation: "'With' significa 'con' (compaÃ±Ã­a)." },
            { q: "The milk is ___ the fridge.", img: "ğŸ¥›", options: ["In", "Under"], correct: "In", explanation: "'In' es dentro de un lugar." },
            { q: "Wait for me ___ the bus stop.", img: "ğŸšŒ", options: ["At", "On"], correct: "At", explanation: "'At' para puntos exactos como una parada de bus." },
            { q: "I write ___ a pencil.", img: "âœï¸", options: ["With", "In"], correct: "With", explanation: "Usamos 'With' para indicar el instrumento (con un lÃ¡piz)." },
            { q: "The slippers are ___ the bed.", img: "ğŸ‘¡", options: ["Under", "At"], correct: "Under", explanation: "'Under' es debajo." },
            { q: "She is ___ school from 9 to 5.", img: "ğŸ«", options: ["At", "With"], correct: "At", explanation: "Estar en el colegio se dice 'At school'." },
            { q: "Eat your soup ___ a spoon.", img: "ğŸ¥£", options: ["With", "On"], correct: "With", explanation: "Comer CON una cuchara." },
            { q: "The ball is ___ the two boxes.", img: "ğŸ“¦âš½ğŸ“¦", options: ["Between", "In"], correct: "Between", explanation: "'Between' es en medio de dos cosas." },
            { q: "My birthday is ___ March.", img: "ğŸ‚", options: ["In", "On"], correct: "In", explanation: "Para los meses del aÃ±o usamos 'In'." },
            { q: "Look ___ that beautiful bird!", img: "ğŸ”­", options: ["At", "With"], correct: "At", explanation: "Mirar algo es 'Look AT'." },
            { q: "I go to the park ___ my dog.", img: "ğŸ•", options: ["With", "Under"], correct: "With", explanation: "Ir CON mi perro." },
            { q: "The computer is ___ the desk.", img: "ğŸ’»", options: ["On", "At"], correct: "On", explanation: "EstÃ¡ apoyado sobre el escritorio." },
            { q: "The bank is ___ the supermarket.", img: "ğŸ¦ğŸ›’", options: ["Next to", "In"], correct: "Next to", explanation: "'Next to' es al lado de." },
            { q: "Are you ___ home?", img: "ğŸ ", options: ["At", "With"], correct: "At", explanation: "Estar en casa se dice 'At home'." },
            { q: "The spider is ___ the ceiling.", img: "ğŸ•·ï¸", options: ["On", "Under"], correct: "On", explanation: "Aunque estÃ© 'colgando', toca la superficie del techo." },
            { q: "I like bread ___ cheese.", img: "ğŸ¥ª", options: ["With", "At"], correct: "With", explanation: "Pan CON queso." },
            { q: "The shoes are ___ the box.", img: "ğŸ‘ŸğŸ“¦", options: ["In", "Between"], correct: "In", explanation: "Dentro de la caja." },
            { q: "Sit ___ me, please.", img: "ğŸª‘", options: ["Next to", "At"], correct: "Next to", explanation: "SiÃ©ntate A MI LADO." }
        ];

        let currentQuestion = 0;
        let score = 0;
        let wrongAnswers = [];
        let currentQuizData = [];

        function startGame(mixed) {
            currentQuizData = [...quizData];
            
            if (mixed) {
                for (let i = currentQuizData.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [currentQuizData[i], currentQuizData[j]] = [currentQuizData[j], currentQuizData[i]];
                }
            }
            
            document.getElementById('mode-screen').classList.add('hidden');
            document.getElementById('game-container').classList.remove('hidden');
            loadQuestion();
        }

        function loadQuestion() {
            const data = currentQuizData[currentQuestion];
            document.getElementById('question-text').innerHTML = data.q;
            document.getElementById('image-placeholder').innerText = data.img;
            
            const grid = document.getElementById('options-grid');
            grid.innerHTML = '';
            
            data.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.innerText = opt;
                btn.className = "option-btn bg-blue-100 border-2 border-blue-400 p-4 rounded-2xl font-bold text-xl text-blue-800 hover:bg-blue-200 shadow-sm";
                btn.onclick = () => checkAnswer(opt);
                grid.appendChild(btn);
            });

            document.getElementById('feedback').classList.add('hidden');
            grid.classList.remove('hidden');
            document.getElementById('stats').innerText = `Pregunta ${currentQuestion + 1} de ${currentQuizData.length}`;
            document.getElementById('progress').style.width = `${((currentQuestion) / currentQuizData.length) * 100}%`;
        }

        function checkAnswer(selected) {
            const data = currentQuizData[currentQuestion];
            const isCorrect = selected === data.correct;
            
            document.getElementById('options-grid').classList.add('hidden');
            const feedback = document.getElementById('feedback');
            feedback.classList.remove('hidden');

            if (isCorrect) {
                score++;
                feedback.className = "mt-6 p-4 rounded-2xl text-center border-2 border-green-500 bg-green-50 bounce";
                document.getElementById('feedback-msg').innerText = "âœ… Â¡GENIAL!";
                document.getElementById('feedback-msg').className = "text-xl font-bold text-green-600 mb-2";
            } else {
                wrongAnswers.push({
                    question: data.q,
                    correct: data.correct,
                    selected: selected,
                    explanation: data.explanation,
                    fullData: data
                });
                feedback.className = "mt-6 p-4 rounded-2xl text-center border-2 border-red-500 bg-red-50 shake";
                document.getElementById('feedback-msg').innerText = "âŒ Â¡CUIDADO!";
                document.getElementById('feedback-msg').className = "text-xl font-bold text-red-600 mb-2";
            }

            document.getElementById('feedback-explanation').innerHTML = `La respuesta correcta es <b>${data.correct}</b>. <br> ${data.explanation}`;
        }

        function nextQuestion() {
            currentQuestion++;
            if (currentQuestion < currentQuizData.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            document.getElementById('game-container').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            document.getElementById('final-score').innerText = score;
            document.getElementById('total-questions').innerText = currentQuizData.length;
            
            const percentage = (score / currentQuizData.length) * 100;

            if (percentage === 100) {
                document.getElementById('final-message').innerText = "Â¡PERFECTO! Has respondido todas las preguntas correctamente. Â¡Eres una estrella!";
                document.getElementById('final-emoji').innerText = "ğŸ†ğŸ‘‘";
            } else if (percentage >= 80) {
                document.getElementById('final-message').innerText = "Â¡Excelente! EstÃ¡s muy lista para el examen de inglÃ©s.";
                document.getElementById('final-emoji').innerText = "ğŸŒŸâœ¨";
            } else if (percentage >= 50) {
                document.getElementById('final-message').innerText = "Â¡Bien hecho! Pero recuerda repasar los fallos para mejorar.";
                document.getElementById('final-emoji').innerText = "ğŸ‘ğŸ“š";
            } else {
                document.getElementById('final-message').innerText = "Sigue practicando un poco mÃ¡s. Â¡TÃº puedes hacerlo!";
                document.getElementById('final-emoji').innerText = "ğŸ’ªğŸ“‹";
            }

            if (wrongAnswers.length > 0) {
                document.getElementById('review-section').classList.remove('hidden');
                document.getElementById('review-btn').classList.remove('hidden');
                document.getElementById('wrong-list').innerHTML = wrongAnswers.map((item, i) => `
                    <div class="mb-3 pb-3 border-b border-red-200 last:border-0">
                        <p class="text-sm"><b>${i + 1}.</b> ${item.question}</p>
                        <p class="text-sm text-red-600">Tu respuesta: <b>${item.selected}</b></p>
                        <p class="text-sm text-green-600">Correcta: <b>${item.correct}</b></p>
                        <p class="text-xs text-gray-600 italic mt-1">${item.explanation}</p>
                    </div>
                `).join('');
                
                document.getElementById('review-btn').onclick = () => {
                    currentQuizData = wrongAnswers.map(wa => wa.fullData);
                    currentQuestion = 0;
                    score = 0;
                    wrongAnswers = [];
                    document.getElementById('result-screen').classList.add('hidden');
                    document.getElementById('game-container').classList.remove('hidden');
                    loadQuestion();
                };
            }
        }
    </script>
</body>
</html>
